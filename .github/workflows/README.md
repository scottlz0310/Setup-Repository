# GitHub Actions ワークフロー

このディレクトリには、Setup-Repositoryプロジェクトの自動化されたワークフローが含まれています。

## ワークフロー一覧

### 1. CI/CD Pipeline (`ci.yml`)
- **トリガー**: プッシュ、プルリクエスト、手動実行
- **目的**: コード品質チェック、テスト実行、パッケージビルド
- **実行内容**:
  - Ruffによるリンティング
  - MyPyによる型チェック
  - Pytestによるテスト実行
  - カバレッジ測定
  - クロスプラットフォームテスト
  - セキュリティスキャン

### 2. Extended CI Matrix (`ci-matrix.yml`)
- **トリガー**: 毎日午前2時（UTC）、手動実行
- **目的**: 包括的な環境でのテスト実行
- **実行内容**:
  - 複数OS（Ubuntu、Windows、macOS）でのテスト
  - 複数Pythonバージョンでのテスト
  - パフォーマンステスト

### 3. Test Report (`test-report.yml`)
- **トリガー**: CI/CDパイプライン完了後
- **目的**: テスト結果の集約とレポート生成
- **実行内容**:
  - テスト結果の収集
  - PRへのコメント投稿
  - テストレポートの生成

### 4. Test CI Pipeline (`test-ci.yml`)
- **トリガー**: 手動実行
- **目的**: CI/CDパイプラインのテストと検証
- **実行内容**:
  - 基本機能テスト
  - フル機能テスト
  - 結果サマリー生成

## 使用方法

### 自動実行
- プッシュやプルリクエスト時に自動的に実行されます
- 毎日の定期実行でより包括的なテストが実行されます

### 手動実行
1. GitHubリポジトリのActionsタブに移動
2. 実行したいワークフローを選択
3. "Run workflow"ボタンをクリック
4. 必要に応じてパラメータを設定して実行

## 設定ファイル

### GitHub Secrets
以下のシークレットを設定してください：
- `CODECOV_TOKEN`: Codecovアップロード用（オプション）

### GitHub Variables
以下の変数を設定できます：
- `PYTHON_DEFAULT_VERSION`: デフォルトPythonバージョン（デフォルト: 3.11）
- `MIN_COVERAGE_THRESHOLD`: 最低カバレッジ閾値（デフォルト: 25）

## トラブルシューティング

### よくある問題
1. **依存関係エラー**: `uv.lock`ファイルが最新でない可能性があります
2. **テスト失敗**: プラットフォーム固有の問題の可能性があります
3. **カバレッジ不足**: 新しいコードにテストが不足している可能性があります

### デバッグ方法
1. ワークフローログを確認
2. ローカル環境で同じコマンドを実行
3. 必要に応じてデバッグ用のワークフローを作成

## 今後の拡張予定

1. **セキュリティスキャンの強化**
   - Dependabotの統合
   - CodeQLの有効化
   - 脆弱性スキャンの自動化

2. **自動リリース管理**
   - タグベースの自動リリース
   - CHANGELOG.mdの自動更新
   - GitHub Releasesの自動作成

3. **パフォーマンス監視**
   - ベンチマークテストの追加
   - パフォーマンス回帰の検出
   - メトリクス収集の自動化

4. **通知機能**
   - Slackやメール通知
   - 失敗時のアラート
   - 成功時のレポート

## 関連ドキュメント

- [CI_SETUP.md](../CI_SETUP.md): CI/CD環境の詳細設定
- [pyproject.toml](../../pyproject.toml): プロジェクト設定とツール設定
- [README.md](../../README.md): プロジェクト全体の概要
